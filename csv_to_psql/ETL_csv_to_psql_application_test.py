import psycopg2

# password deleted
conn = psycopg2.connect("host=localhost dbname=postgres user=postgres password=54zhusiqi")
cur = conn.cursor()

# Build tabel
cur.execute("""
DROP TABLE IF EXISTS kaggle_hcdr.application_test;
CREATE TABLE kaggle_hcdr.application_test
(
    SK_ID_CURR numeric,
    NAME_CONTRACT_TYPE text,
    CODE_GENDER text,
    FLAG_OWN_CAR text,
    FLAG_OWN_REALTY text,
    CNT_CHILDREN numeric,
    AMT_INCOME_TOTAL numeric,
    AMT_CREDIT numeric,
    AMT_ANNUITY numeric,
    AMT_GOODS_PRICE numeric,
    NAME_TYPE_SUITE text,
    NAME_INCOME_TYPE text,
    NAME_EDUCATION_TYPE text,
    NAME_FAMILY_STATUS text,
    NAME_HOUSING_TYPE text,
    REGION_POPULATION_RELATIVE numeric,
    DAYS_BIRTH numeric,
    DAYS_EMPLOYED numeric,
    DAYS_REGISTRATION numeric,
    DAYS_ID_PUBLISH numeric,
    OWN_CAR_AGE text,
    FLAG_MOBIL numeric,
    FLAG_EMP_PHONE numeric,
    FLAG_WORK_PHONE numeric,
    FLAG_CONT_MOBILE numeric,
    FLAG_PHONE numeric,
    FLAG_EMAIL numeric,
    OCCUPATION_TYPE text,
    CNT_FAM_MEMBERS numeric,
    REGION_RATING_CLIENT numeric,
    REGION_RATING_CLIENT_W_CITY numeric,
    WEEKDAY_APPR_PROCESS_START text,
    HOUR_APPR_PROCESS_START numeric,
    REG_REGION_NOT_LIVE_REGION numeric,
    REG_REGION_NOT_WORK_REGION numeric,
    LIVE_REGION_NOT_WORK_REGION numeric,
    REG_CITY_NOT_LIVE_CITY numeric,
    REG_CITY_NOT_WORK_CITY numeric,
    LIVE_CITY_NOT_WORK_CITY numeric,
    ORGANIZATION_TYPE text,
    EXT_SOURCE_1 text,
    EXT_SOURCE_2 numeric,
    EXT_SOURCE_3 text,
    APARTMENTS_AVG text,
    BASEMENTAREA_AVG text,
    YEARS_BEGINEXPLUATATION_AVG text,
    YEARS_BUILD_AVG text,
    COMMONAREA_AVG text,
    ELEVATORS_AVG text,
    ENTRANCES_AVG text,
    FLOORSMAX_AVG text,
    FLOORSMIN_AVG text,
    LANDAREA_AVG text,
    LIVINGAPARTMENTS_AVG text,
    LIVINGAREA_AVG text,
    NONLIVINGAPARTMENTS_AVG text,
    NONLIVINGAREA_AVG text,
    APARTMENTS_MODE text,
    BASEMENTAREA_MODE text,
    YEARS_BEGINEXPLUATATION_MODE text,
    YEARS_BUILD_MODE text,
    COMMONAREA_MODE text,
    ELEVATORS_MODE text,
    ENTRANCES_MODE text,
    FLOORSMAX_MODE text,
    FLOORSMIN_MODE text,
    LANDAREA_MODE text,
    LIVINGAPARTMENTS_MODE text,
    LIVINGAREA_MODE text,
    NONLIVINGAPARTMENTS_MODE text,
    NONLIVINGAREA_MODE text,
    APARTMENTS_MEDI text,
    BASEMENTAREA_MEDI text,
    YEARS_BEGINEXPLUATATION_MEDI text,
    YEARS_BUILD_MEDI text,
    COMMONAREA_MEDI text,
    ELEVATORS_MEDI text,
    ENTRANCES_MEDI text,
    FLOORSMAX_MEDI text,
    FLOORSMIN_MEDI text,
    LANDAREA_MEDI text,
    LIVINGAPARTMENTS_MEDI text,
    LIVINGAREA_MEDI text,
    NONLIVINGAPARTMENTS_MEDI text,
    NONLIVINGAREA_MEDI text,
    FONDKAPREMONT_MODE text,
    HOUSETYPE_MODE text,
    TOTALAREA_MODE text,
    WALLSMATERIAL_MODE text,
    EMERGENCYSTATE_MODE text,
    OBS_30_CNT_SOCIAL_CIRCLE text,
    DEF_30_CNT_SOCIAL_CIRCLE text,
    OBS_60_CNT_SOCIAL_CIRCLE text,
    DEF_60_CNT_SOCIAL_CIRCLE text,
    DAYS_LAST_PHONE_CHANGE numeric,
    FLAG_DOCUMENT_2 numeric,
    FLAG_DOCUMENT_3 numeric,
    FLAG_DOCUMENT_4 numeric,
    FLAG_DOCUMENT_5 numeric,
    FLAG_DOCUMENT_6 numeric,
    FLAG_DOCUMENT_7 numeric,
    FLAG_DOCUMENT_8 numeric,
    FLAG_DOCUMENT_9 numeric,
    FLAG_DOCUMENT_10 numeric,
    FLAG_DOCUMENT_11 numeric,
    FLAG_DOCUMENT_12 numeric,
    FLAG_DOCUMENT_13 numeric,
    FLAG_DOCUMENT_14 numeric,
    FLAG_DOCUMENT_15 numeric,
    FLAG_DOCUMENT_16 numeric,
    FLAG_DOCUMENT_17 numeric,
    FLAG_DOCUMENT_18 numeric,
    FLAG_DOCUMENT_19 numeric,
    FLAG_DOCUMENT_20 numeric,
    FLAG_DOCUMENT_21 numeric,
    AMT_REQ_CREDIT_BUREAU_HOUR text,
    AMT_REQ_CREDIT_BUREAU_DAY text,
    AMT_REQ_CREDIT_BUREAU_WEEK text,
    AMT_REQ_CREDIT_BUREAU_MON text,
    AMT_REQ_CREDIT_BUREAU_QRT text,
    AMT_REQ_CREDIT_BUREAU_YEAR text,
    SK_ID_BUREAU integer,
    MONTHS_BALANCE text,
    STATUS text
)
""")

cur.execute("""
    COPY kaggle_hcdr.application_test(SK_ID_CURR, NAME_CONTRACT_TYPE ,CODE_GENDER ,FLAG_OWN_CAR ,FLAG_OWN_REALTY ,CNT_CHILDREN ,AMT_INCOME_TOTAL ,AMT_CREDIT ,AMT_ANNUITY ,AMT_GOODS_PRICE ,NAME_TYPE_SUITE ,NAME_INCOME_TYPE ,NAME_EDUCATION_TYPE ,NAME_FAMILY_STATUS ,NAME_HOUSING_TYPE ,REGION_POPULATION_RELATIVE ,DAYS_BIRTH ,DAYS_EMPLOYED ,DAYS_REGISTRATION ,DAYS_ID_PUBLISH ,OWN_CAR_AGE ,FLAG_MOBIL ,FLAG_EMP_PHONE ,FLAG_WORK_PHONE ,FLAG_CONT_MOBILE ,FLAG_PHONE ,FLAG_EMAIL ,OCCUPATION_TYPE ,CNT_FAM_MEMBERS ,REGION_RATING_CLIENT ,REGION_RATING_CLIENT_W_CITY ,WEEKDAY_APPR_PROCESS_START ,HOUR_APPR_PROCESS_START ,REG_REGION_NOT_LIVE_REGION ,REG_REGION_NOT_WORK_REGION ,LIVE_REGION_NOT_WORK_REGION ,REG_CITY_NOT_LIVE_CITY ,REG_CITY_NOT_WORK_CITY ,LIVE_CITY_NOT_WORK_CITY ,ORGANIZATION_TYPE ,EXT_SOURCE_1 ,EXT_SOURCE_2 ,EXT_SOURCE_3 ,APARTMENTS_AVG ,BASEMENTAREA_AVG ,YEARS_BEGINEXPLUATATION_AVG ,YEARS_BUILD_AVG ,COMMONAREA_AVG ,ELEVATORS_AVG ,ENTRANCES_AVG ,FLOORSMAX_AVG ,FLOORSMIN_AVG ,LANDAREA_AVG ,LIVINGAPARTMENTS_AVG ,LIVINGAREA_AVG ,NONLIVINGAPARTMENTS_AVG ,NONLIVINGAREA_AVG ,APARTMENTS_MODE ,BASEMENTAREA_MODE ,YEARS_BEGINEXPLUATATION_MODE ,YEARS_BUILD_MODE ,COMMONAREA_MODE ,ELEVATORS_MODE ,ENTRANCES_MODE ,FLOORSMAX_MODE ,FLOORSMIN_MODE ,LANDAREA_MODE ,LIVINGAPARTMENTS_MODE ,LIVINGAREA_MODE ,NONLIVINGAPARTMENTS_MODE ,NONLIVINGAREA_MODE ,APARTMENTS_MEDI ,BASEMENTAREA_MEDI ,YEARS_BEGINEXPLUATATION_MEDI ,YEARS_BUILD_MEDI ,COMMONAREA_MEDI ,ELEVATORS_MEDI ,ENTRANCES_MEDI ,FLOORSMAX_MEDI ,FLOORSMIN_MEDI ,LANDAREA_MEDI ,LIVINGAPARTMENTS_MEDI ,LIVINGAREA_MEDI ,NONLIVINGAPARTMENTS_MEDI ,NONLIVINGAREA_MEDI ,FONDKAPREMONT_MODE ,HOUSETYPE_MODE ,TOTALAREA_MODE ,WALLSMATERIAL_MODE ,EMERGENCYSTATE_MODE ,OBS_30_CNT_SOCIAL_CIRCLE ,DEF_30_CNT_SOCIAL_CIRCLE ,OBS_60_CNT_SOCIAL_CIRCLE ,DEF_60_CNT_SOCIAL_CIRCLE ,DAYS_LAST_PHONE_CHANGE ,FLAG_DOCUMENT_2 ,FLAG_DOCUMENT_3 ,FLAG_DOCUMENT_4 ,FLAG_DOCUMENT_5 ,FLAG_DOCUMENT_6 ,FLAG_DOCUMENT_7 ,FLAG_DOCUMENT_8 ,FLAG_DOCUMENT_9 ,FLAG_DOCUMENT_10 ,FLAG_DOCUMENT_11 ,FLAG_DOCUMENT_12 ,FLAG_DOCUMENT_13 ,FLAG_DOCUMENT_14 ,FLAG_DOCUMENT_15 ,FLAG_DOCUMENT_16 ,FLAG_DOCUMENT_17 ,FLAG_DOCUMENT_18,FLAG_DOCUMENT_19 ,FLAG_DOCUMENT_20 ,FLAG_DOCUMENT_21 ,AMT_REQ_CREDIT_BUREAU_HOUR ,AMT_REQ_CREDIT_BUREAU_DAY ,AMT_REQ_CREDIT_BUREAU_WEEK ,AMT_REQ_CREDIT_BUREAU_MON ,AMT_REQ_CREDIT_BUREAU_QRT ,AMT_REQ_CREDIT_BUREAU_YEAR) 
    FROM 'D:\\Projects\\Home_Credit_Default_Risk\\data\\application_test.csv' DELIMITER ',' CSV HEADER;
""")

conn.commit()


